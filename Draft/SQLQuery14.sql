Select t2.DocNum as 'Invoice/Credit Num', CASEWHEN t0.BaseType = '17' THEN t0.BaseRefWHEN t0.BaseType = '15' THEN (select t4.BaseRef from DLN1 t4 where t0.BaseEntry = t4.DocEntry and t0.BaseLine = t4.LineNum)ELSE NULLEND as 'OrderNum',t2.DocDate as 'InvDate',CASEWHEN t0.BaseType = '17' THEN (select t5.DocDate from ORDR t5 where t0.BaseEntry = t5.DocEntry)WHEN t0.BaseType = '15' THEN (select t5.DocDate from ORDR t5 where t5.DocEntry = (select MAX(t4.BaseEntry) from DLN1 t4 where t0.BaseEntry = t4.DocEntry))ELSE NULLEND as 'OrderDate',t2.Cardname as 'Customer',t2.CardCode as 'Cust Code', (select slpname from oslp t4 where t4.SlpCode = t5.u_sm1) as 'SLSM1', (select slpname from oslp t4 where t4.SlpCode = t5.u_sm2) as 'SLSM2',t2.ShipToCode, t3.CityS,t3.StateS, t2.NumAtCard as 'CustPONum', t0.LineNum, t0.ItemCode,t1.frgnname AS 'Base Itemcode',t1.itemname, t1.slength1 as 'Around', t1.swidth1 as 'Across', t1.sheight1 as 'Gauge', t0.u_ship_quantity as 'Pieces', t0.Quantity, t0.Price, t0.LineTotalfrom inv1 t0left outer join oitm t1 on t0.ItemCode = t1.ItemCodeinner join oinv t2 on t0.docentry = t2.docentryleft outer join inv12 t3 on t0.DocEntry = t3.DocEntryleft outer join oslp t4 on t2.slpcode = t4.slpcodeleft outer join crd1 t5 on t5.address = t2.ShipToCode and t2.cardcode = t5.cardcode and t5.adrestype = 'S'left outer join ocrd t6 on t2.cardcode = t6.cardcodewheret2.docdate >= '2021-01-02' and t2.docdate <='2021-01-31' andt2.canceled = 'N'and t6.qrygroup1 = 'N' --and t2.DocNum=700020ORDER BY t2.DocNum--UNION ALL--Select t2.DocNum ,--CASE--WHEN t0.BaseType = '13' THEN (select t4.BaseRef from DLN1 t4 where t4.TrgetEntry = t0.BaseEntry  and t0.BaseLine = t4.LineNum AND T4.TargetType=T0.BaseType)--ELSE NULL--END as 'OrderNum',--t2.DocDate,--NULL,--t2.Cardname as 'Customer', --t2.CardCode as 'Cust Code',--(select slpname from oslp t4 where t4.SlpCode = t5.u_sm1) as 'SLSM1', --(select slpname from oslp t4 where t4.SlpCode = t5.u_sm2) as 'SLSM2',--t2.ShipToCode, --t3.CityS, --t3.StateS, --t2.NumAtCard as 'CustPONum', --t0.LineNum, --t0.ItemCode,--t1.frgnname AS 'Base Itemcode',--t1.itemname, --t1.slength1 as 'Around', t1.swidth1 as 'Across', t1.sheight1 as 'Gauge',--t0.u_ship_quantity as 'Pieces',--t0.Quantity, ---(t0.Price), ---(t0.LineTotal)--from RIN1 t0--left outer join oitm t1 on t0.ItemCode = t1.ItemCode--inner join ORIN t2 on t0.docentry = t2.docentry--left outer join RIN12 t3 on t0.DocEntry = t3.DocEntry--left outer join oslp t4 on t2.slpcode = t4.slpcode--left outer join crd1 t5 on t5.address = t2.ShipToCode and t2.cardcode = t5.cardcode and t5.adrestype = 'S'--left outer join ocrd t6 on t2.cardcode = t6.cardcode--where--t2.docdate >= '2022-02-01' and t2.docdate <= '2022-03-11' and--t2.canceled = 'N'--and t6.qrygroup1 = 'N'